# Diagrama de Fluxo - RevisÃ£o de Prazos

> **ğŸ“– DocumentaÃ§Ã£o Relacionada:**
> - [Resumo Executivo](./TIME_REVISION_FLOW_SUMMARY.md) - VisÃ£o rÃ¡pida e checklist
> - [Controle Detalhado](./TIME_REVISION_FLOW_CONTROL.md) - ExplicaÃ§Ã£o tÃ©cnica completa
> - [Planejamento Original](./PARTNER_TIME_REVISION_FLOW.md) - EspecificaÃ§Ã£o inicial

---

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FLUXO DE REVISÃƒO DE PRAZOS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PARCEIRO       â”‚
â”‚  Cria OrÃ§amento â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Status: pending_partner â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Parceiro submete
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Status: pending_admin_approvalâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Admin aprova
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Status: approved â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
         â”‚                                                    â”‚
         â”‚ Especialista analisa prazos                       â”‚
         â”‚                                                    â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                                            â”‚
    â”‚          â”‚                                            â”‚
    â–¼          â–¼                                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ APROVADOâ”‚  â”‚     SOLICITA REVISÃƒO                â”‚       â”‚
â”‚         â”‚  â”‚                                     â”‚       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â”‚ POST /specialist/quotes/      â”‚
     â”‚                      â”‚      [quoteId]/review-times   â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â–¼                               â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
     â”‚       â”‚ Cria registro:                       â”‚       â”‚
     â”‚       â”‚   action: 'revision_requested'       â”‚       â”‚
     â”‚       â”‚   revision_requests: {               â”‚       â”‚
     â”‚       â”‚     "item-id": {                     â”‚       â”‚
     â”‚       â”‚       suggested_days: 5,             â”‚       â”‚
     â”‚       â”‚       reason: "..."                  â”‚       â”‚
     â”‚       â”‚     }                                â”‚       â”‚
     â”‚       â”‚   }                                  â”‚       â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â–¼                               â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
     â”‚       â”‚ Status: specialist_time_revision_requestedâ”‚  â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â”‚ âš ï¸ PARCEIRO DEVE AGIR          â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â–¼                               â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
     â”‚       â”‚ CARD: "RevisÃ£o de Prazos Solicitada"â”‚        â”‚
     â”‚       â”‚ (laranja, urgente)                â”‚         â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â”‚ Parceiro clica "Revisar Prazos"â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â–¼                               â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
     â”‚       â”‚ TimeRevisionModal                 â”‚         â”‚
     â”‚       â”‚ - Mostra sugestÃµes do especialistaâ”‚         â”‚
     â”‚       â”‚ - Permite editar prazos           â”‚         â”‚
     â”‚       â”‚ - BotÃ£o "Aplicar SugestÃ£o"        â”‚         â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â”‚ PUT /partner/quotes/          â”‚
     â”‚                      â”‚     [quoteId]/update-times    â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â–¼                               â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
     â”‚       â”‚ 1. Atualiza quote_items:             â”‚       â”‚
     â”‚       â”‚    SET estimated_days = :newDays     â”‚       â”‚
     â”‚       â”‚                                      â”‚       â”‚
     â”‚       â”‚ 2. Cria registro:                    â”‚       â”‚
     â”‚       â”‚    action: 'partner_updated'         â”‚       â”‚
     â”‚       â”‚    comments: "Prazos ajustados..."   â”‚       â”‚
     â”‚       â”‚                                      â”‚       â”‚
     â”‚       â”‚ 3. Atualiza status:                  â”‚       â”‚
     â”‚       â”‚    status = 'admin_review'           â”‚       â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â–¼                               â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
     â”‚       â”‚ Status: admin_review        â”‚                â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â–¼                               â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
     â”‚       â”‚ CARD: "OrÃ§amentos em AnÃ¡lise"     â”‚         â”‚
     â”‚       â”‚ (branco, informativo)             â”‚         â”‚
     â”‚       â”‚ has_time_revision: true           â”‚         â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â”‚ âš ï¸ ESPECIALISTA DEVE REVISAR   â”‚
     â”‚                      â”‚    OS NOVOS PRAZOS            â”‚
     â”‚                      â”‚                               â”‚
     â”‚                      â–¼                               â”‚
     â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
     â”‚       â”‚ Especialista Analisa Ajustes        â”‚        â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
     â”‚                      â”‚                               â”‚
     â”‚                 â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                         â”‚
     â”‚                 â”‚          â”‚                         â”‚
     â”‚                 â–¼          â–¼                         â”‚
     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
     â”‚         â”‚ APROVADOâ”‚   â”‚ SOLICITA NOVA    â”‚          â”‚
     â”‚         â”‚         â”‚   â”‚ REVISÃƒO (LOOP)   â”‚          â”‚
     â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
     â”‚              â”‚               â”‚                      â”‚
     â”‚              â”‚               â”‚ POST /specialist/    â”‚
     â”‚              â”‚               â”‚      review-times    â”‚
     â”‚              â”‚               â”‚ action: revision_    â”‚
     â”‚              â”‚               â”‚         requested    â”‚
     â”‚              â”‚               â”‚                      â”‚
     â”‚              â”‚               â–¼                      â”‚
     â”‚              â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
     â”‚              â”‚    â”‚ Status:                     â”‚   â”‚
     â”‚              â”‚    â”‚ specialist_time_revision_   â”‚   â”‚
     â”‚              â”‚    â”‚         requested           â”‚   â”‚
     â”‚              â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
     â”‚              â”‚               â”‚                      â”‚
     â”‚              â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚            â™»ï¸ VOLTA AO CARD LARANJA
     â”‚              â”‚            (novo ciclo de revisÃ£o)
     â”‚              â”‚
     â”‚              â–¼
     â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   â”‚ Status: specialist_time_approvedâ”‚
     â”‚   â”‚ (Prazos aprovados pelo especialista)â”‚
     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚
     â”‚                  â”‚ Admin aprova orÃ§amento final
     â”‚                  â”‚
     â”‚                  â–¼
     â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚      â”‚ Admin aprova                â”‚
     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                     â”‚
     â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                         (volta para approved - execuÃ§Ã£o)
     â”‚
     â–¼
   [Continua fluxo de execuÃ§Ã£o...]


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            TABELA DE TRANSIÃ‡Ã•ES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Status Atual      â”‚  AÃ§Ã£o                â”‚  PrÃ³ximo Status                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pending_partner    â”‚ Parceiro submete     â”‚ pending_admin_approval          â”‚
â”‚ pending_admin_approvalâ”‚ Admin aprova      â”‚ approved                        â”‚
â”‚ approved           â”‚ Especialista aprova  â”‚ specialist_time_approved        â”‚
â”‚ approved           â”‚ Especialista revisa  â”‚ specialist_time_revision_requestedâ”‚
â”‚ specialist_time_   â”‚ Parceiro atualiza    â”‚ admin_review                    â”‚
â”‚ revision_requested â”‚                      â”‚                                 â”‚
â”‚ admin_review       â”‚ Especialista aprova  â”‚ specialist_time_approved        â”‚
â”‚ admin_review       â”‚ Especialista revisa  â”‚ specialist_time_revision_requestedâ”‚
â”‚                    â”‚ (nova rodada)        â”‚ â™»ï¸ LOOP                         â”‚
â”‚ specialist_time_   â”‚ Admin aprova final   â”‚ approved (execuÃ§Ã£o)             â”‚
â”‚ approved           â”‚                      â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸ IMPORTANTE: O loop admin_review â†” specialist_time_revision_requested pode
se repetir MÃšLTIPLAS VEZES atÃ© que o especialista aprove os prazos.


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        REGISTROS NA quote_time_reviews
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action              â”‚  Criado Por     â”‚  Quando                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ revision_requested   â”‚ Especialista    â”‚ Especialista solicita revisÃ£o      â”‚
â”‚                      â”‚                 â”‚ - specialist_id: UUID              â”‚
â”‚                      â”‚                 â”‚ - revision_requests: JSONB         â”‚
â”‚                      â”‚                 â”‚ - comments: TEXT                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ approved             â”‚ Especialista    â”‚ Especialista aprova todos os prazosâ”‚
â”‚                      â”‚                 â”‚ - specialist_id: UUID              â”‚
â”‚                      â”‚                 â”‚ - comments: TEXT                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ partner_updated      â”‚ Parceiro        â”‚ Parceiro ajusta prazos solicitados â”‚
â”‚                      â”‚                 â”‚ - specialist_id: NULL              â”‚
â”‚                      â”‚                 â”‚ - comments: TEXT                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            CARDS DO DASHBOARD PARCEIRO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CARD 1: "RevisÃ£o de Prazos Solicitada" (Laranja/Urgente)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API: GET /api/partner/quotes/pending-time-revisions                        â”‚
â”‚                                                                              â”‚
â”‚  Filtro: status = 'specialist_time_revision_requested'                      â”‚
â”‚                                                                              â”‚
â”‚  Exibe:                                                                      â”‚
â”‚    - OrÃ§amento #ABC123                                                       â”‚
â”‚    - VeÃ­culo: ABC-1234 | Cliente: JoÃ£o Silva                               â”‚
â”‚    - Solicitado hÃ¡: 2 dias                                                  â”‚
â”‚    - ComentÃ¡rio: "Prazos muito curtos para serviÃ§os complexos"             â”‚
â”‚                                                                              â”‚
â”‚  AÃ§Ãµes:                                                                      â”‚
â”‚    [Revisar Prazos] â†’ Abre TimeRevisionModal                               â”‚
â”‚    [Ver Detalhes]   â†’ Abre pÃ¡gina do orÃ§amento                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CARD 2: "OrÃ§amentos em AnÃ¡lise" (Branco/Informativo)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API: GET /api/partner/quotes/in-review                                     â”‚
â”‚                                                                              â”‚
â”‚  Filtro: status IN ('admin_review', 'pending_admin_approval',               â”‚
â”‚                     'specialist_time_revision_requested')                   â”‚
â”‚                                                                              â”‚
â”‚  Exibe (com has_time_revision: true):                                       â”‚
â”‚    - OrÃ§amento #XYZ789                                                       â”‚
â”‚    - VeÃ­culo: XYZ-5678 | Cliente: Maria Santos                             â”‚
â”‚    - Aguardando hÃ¡: 1 dia                                                   â”‚
â”‚    - Status: "SolicitaÃ§Ã£o de revisÃ£o de prazos pelo especialista"          â”‚
â”‚                                                                              â”‚
â”‚  Exibe (com has_time_revision: false):                                      â”‚
â”‚    - OrÃ§amento #DEF456                                                       â”‚
â”‚    - VeÃ­culo: DEF-9012 | Cliente: Pedro Costa                              â”‚
â”‚    - Aguardando hÃ¡: 3 dias                                                  â”‚
â”‚    - Status: "Aguardando revisÃ£o do admin - VocÃª jÃ¡ fez sua parte!"        â”‚
â”‚                                                                              â”‚
â”‚  AÃ§Ãµes:                                                                      â”‚
â”‚    [Revisar Prazos] (se has_time_revision) â†’ TimeRevisionModal             â”‚
â”‚    [Ver Detalhes]   (se !has_time_revision) â†’ PÃ¡gina do orÃ§amento          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         LÃ“GICA DE DECISÃƒO NO FRONTEND
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// PartnerDashboard.tsx
const handleViewQuoteDetails = (quoteId: string) => {
  const quote = quotesInReview.find(q => q.quote_id === quoteId);
  
  if (quote?.has_time_revision) {
    // TEM REVISÃƒO: Abre modal de ediÃ§Ã£o
    setSelectedQuoteForRevision(quoteId);
    setShowTimeRevisionModal(true);
  } else {
    // SEM REVISÃƒO: Redireciona para visualizaÃ§Ã£o
    router.push(`/dashboard/partner/orcamento?quoteId=${quoteId}`);
  }
};


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                       EXEMPLO DE HISTÃ“RICO COM MÃšLTIPLAS REVISÃ•ES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Quote ID: 94621dbc-3bb7-45e1-8b73-1810175b2ecb

Timeline:
  
  1. 2025-10-10 09:00 | quotes.status = 'pending_partner'
     â†’ OrÃ§amento criado
  
  2. 2025-10-10 10:00 | quotes.status = 'pending_admin_approval'
     â†’ Parceiro submeteu orÃ§amento
  
  3. 2025-10-11 14:00 | quotes.status = 'approved'
     â†’ Admin aprovou orÃ§amento
  
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                       ğŸ”„ INÃCIO DO CICLO DE REVISÃ•ES                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  4. 2025-10-12 11:00 | quote_time_reviews.action = 'revision_requested'
                      | quotes.status = 'specialist_time_revision_requested'
     â†’ âš ï¸ [1Âª REVISÃƒO] Especialista solicitou revisÃ£o de prazos
     â†’ revision_requests: {
         "item-1": {suggested_days: 5, reason: "Muito curto"},
         "item-2": {suggested_days: 3, reason: "Aguardar peÃ§as"}
       }
  
  5. 2025-10-13 15:30 | quote_time_reviews.action = 'partner_updated'
                      | quote_items.estimated_days atualizado
                      | quotes.status = 'admin_review'
     â†’ âœ… [1Âª RESPOSTA] Parceiro ajustou prazos
     â†’ Item-1: 2 dias â†’ 5 dias
     â†’ Item-2: 1 dia â†’ 3 dias
  
  6. 2025-10-14 10:00 | quote_time_reviews.action = 'revision_requested'
                      | quotes.status = 'specialist_time_revision_requested'
     â†’ âš ï¸ [2Âª REVISÃƒO] Especialista solicita NOVA revisÃ£o (loop)
     â†’ revision_requests: {
         "item-1": {suggested_days: 7, reason: "Ainda insuficiente"}
       }
     â†’ ComentÃ¡rio: "Item-2 OK, mas item-1 precisa mais tempo"
  
  7. 2025-10-14 16:00 | quote_time_reviews.action = 'partner_updated'
                      | quote_items.estimated_days atualizado
                      | quotes.status = 'admin_review'
     â†’ âœ… [2Âª RESPOSTA] Parceiro ajustou novamente
     â†’ Item-1: 5 dias â†’ 7 dias
  
  8. 2025-10-15 09:00 | quote_time_reviews.action = 'approved'
                      | quotes.status = 'specialist_time_approved'
     â†’ âœ… [APROVAÃ‡ÃƒO FINAL] Especialista aprovou prazos finais
     â†’ ComentÃ¡rio: "Prazos adequados, pode prosseguir"
  
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                       âœ… FIM DO CICLO DE REVISÃ•ES                    â”‚
  â”‚                     (ApÃ³s 2 rodadas de revisÃ£o)                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  9. 2025-10-15 14:00 | quotes.status = 'approved'
     â†’ Admin aprova orÃ§amento final para execuÃ§Ã£o


RESUMO DO CICLO:
  - 2 solicitaÃ§Ãµes de revisÃ£o pelo especialista
  - 2 atualizaÃ§Ãµes de prazos pelo parceiro
  - 1 aprovaÃ§Ã£o final do especialista
  - Total de 5 registros na quote_time_reviews
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              QUERIES DE VERIFICAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Verificar se orÃ§amento tem revisÃ£o solicitada
SELECT 
  q.id,
  q.status,
  EXISTS(
    SELECT 1 
    FROM quote_time_reviews qtr 
    WHERE qtr.quote_id = q.id 
      AND qtr.action = 'revision_requested'
  ) as has_revision_requested,
  EXISTS(
    SELECT 1 
    FROM quote_time_reviews qtr 
    WHERE qtr.quote_id = q.id 
      AND qtr.action = 'partner_updated'
  ) as partner_already_updated
FROM quotes q
WHERE q.id = '94621dbc-3bb7-45e1-8b73-1810175b2ecb';


-- Ver Ãºltima aÃ§Ã£o de cada tipo
SELECT DISTINCT ON (action)
  action,
  created_at,
  comments
FROM quote_time_reviews
WHERE quote_id = '94621dbc-3bb7-45e1-8b73-1810175b2ecb'
ORDER BY action, created_at DESC;


-- Contar ciclos de revisÃ£o
SELECT 
  COUNT(*) FILTER (WHERE action = 'revision_requested') as revision_count,
  COUNT(*) FILTER (WHERE action = 'partner_updated') as update_count,
  COUNT(*) FILTER (WHERE action = 'approved') as approval_count
FROM quote_time_reviews
WHERE quote_id = '94621dbc-3bb7-45e1-8b73-1810175b2ecb';
```


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          âš ï¸ GAPS DE IMPLEMENTAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROBLEMA 1: ESPECIALISTA NÃƒO Ã‰ NOTIFICADO                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Status Atual:                                                               â”‚
â”‚    Parceiro atualiza prazos â†’ status = 'admin_review'                      â”‚
â”‚    âŒ Especialista nÃ£o recebe notificaÃ§Ã£o                                    â”‚
â”‚    âŒ Especialista nÃ£o tem dashboard de "pendentes de revisÃ£o"              â”‚
â”‚    âŒ Processo fica travado esperando aÃ§Ã£o do especialista                  â”‚
â”‚                                                                              â”‚
â”‚  SoluÃ§Ãµes NecessÃ¡rias:                                                       â”‚
â”‚    1. âœ… Criar API: GET /api/specialist/quotes/pending-review               â”‚
â”‚    2. âœ… Criar Card no Dashboard do Especialista                            â”‚
â”‚    3. âœ… Enviar notificaÃ§Ã£o por email/push                                  â”‚
â”‚    4. âœ… Mudar status para 'pending_specialist_review' (mais claro)         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROBLEMA 2: LOOP INFINITO NÃƒO CONTROLADO                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  CenÃ¡rio ProblemÃ¡tico:                                                       â”‚
â”‚    Especialista solicita revisÃ£o â†’ Parceiro ajusta                          â”‚
â”‚    â†’ Especialista rejeita novamente â†’ Parceiro ajusta                       â”‚
â”‚    â†’ Especialista rejeita novamente... (infinito)                           â”‚
â”‚                                                                              â”‚
â”‚  Impactos:                                                                   â”‚
â”‚    âŒ FrustraÃ§Ã£o de ambas as partes                                          â”‚
â”‚    âŒ OrÃ§amento pode ficar travado indefinidamente                          â”‚
â”‚    âŒ Sem mÃ©tricas de quantas revisÃµes foram feitas                         â”‚
â”‚                                                                              â”‚
â”‚  SoluÃ§Ãµes NecessÃ¡rias:                                                       â”‚
â”‚    1. âœ… Adicionar coluna: quotes.revision_count                            â”‚
â”‚    2. âœ… Limitar a 3 revisÃµes mÃ¡ximo                                        â”‚
â”‚    3. âœ… ApÃ³s limite, escalar para admin decidir                            â”‚
â”‚    4. âœ… Exibir contador de revisÃµes no frontend                            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROBLEMA 3: FALTA HISTÃ“RICO VISUAL                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Necessidades:                                                               â”‚
â”‚    âŒ Timeline visual mostrando todas as revisÃµes                           â”‚
â”‚    âŒ Comparativo: prazo original â†’ sugerido â†’ ajustado                     â”‚
â”‚    âŒ HistÃ³rico de comentÃ¡rios em ordem cronolÃ³gica                         â”‚
â”‚                                                                              â”‚
â”‚  Onde Mostrar:                                                               â”‚
â”‚    1. Modal de revisÃ£o de prazos (para parceiro)                            â”‚
â”‚    2. Modal de anÃ¡lise de prazos (para especialista)                        â”‚
â”‚    3. Dashboard admin (visÃ£o geral)                                         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                       FLUXO IDEAL COM MELHORIAS IMPLEMENTADAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASSO 1: Especialista Solicita RevisÃ£o                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POST /api/specialist/quotes/[quoteId]/review-times                         â”‚
â”‚  âœ… Status: approved â†’ specialist_time_revision_requested                   â”‚
â”‚  âœ… Cria registro: action = 'revision_requested'                            â”‚
â”‚  âœ… Incrementa: revision_count = 1                                          â”‚
â”‚  âœ… NotificaÃ§Ã£o: Email/Push para parceiro                                   â”‚
â”‚  âœ… Card Laranja: Aparece no dashboard do parceiro                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASSO 2: Parceiro Atualiza Prazos                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PUT /api/partner/quotes/[quoteId]/update-times                             â”‚
â”‚  âœ… Atualiza: quote_items.estimated_days                                    â”‚
â”‚  âœ… Cria registro: action = 'partner_updated'                               â”‚
â”‚  âœ… Status: specialist_time_revision_requested â†’ pending_specialist_review  â”‚
â”‚  âœ… NotificaÃ§Ã£o: Email/Push para especialista                               â”‚
â”‚  âœ… Card: Aparece em "Pendentes de RevisÃ£o" do especialista                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASSO 3: Especialista Revisa Novamente                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GET /api/specialist/quotes/pending-review                                  â”‚
â”‚  âœ… Lista orÃ§amentos em pending_specialist_review                           â”‚
â”‚  âœ… Mostra histÃ³rico completo de revisÃµes                                   â”‚
â”‚  âœ… Exibe contador: "RevisÃ£o 1 de 3"                                        â”‚
â”‚                                                                              â”‚
â”‚  DecisÃ£o do Especialista:                                                   â”‚
â”‚    A) Aprovar â†’ specialist_time_approved (FIM)                              â”‚
â”‚    B) Solicitar nova revisÃ£o â†’ Verifica revision_count                      â”‚
â”‚       - Se < 3: Permite nova revisÃ£o (LOOP)                                 â”‚
â”‚       - Se >= 3: Bloqueia e escala para admin                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            STATUS SUGERIDOS (NOVOS)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Status Atual                     â”‚  Status Sugerido (Mais Claro)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ admin_review                      â”‚ pending_specialist_review               â”‚
â”‚ (genÃ©rico, nÃ£o fica claro         â”‚ (deixa explÃ­cito que especialista       â”‚
â”‚  quem deve agir)                  â”‚  precisa revisar novamente)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Vantagens do novo status:
  âœ… Fica claro no cÃ³digo quem Ã© o responsÃ¡vel pela aÃ§Ã£o
  âœ… Facilita criar queries para dashboard do especialista
  âœ… Evita confusÃ£o com outras revisÃµes do admin
  âœ… Permite RLS policies mais especÃ­ficas

